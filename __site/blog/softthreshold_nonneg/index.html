<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
     
  
  <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/hypertext.css">
<link rel="icon" href="/assets/favicon.png">

   <title>Soft-thresholding operator with [0,1] constraint</title>  
</head>
<body>
<header>
  <h1 style="color:#283747">Mathematics</h1>
  <nav>
    <a href="/" class="current">Tags</a>
  | <a href="/blog" >Notes</a>
  <hr/>
  </nav>
</header>


<!-- Content appended here -->
<div class="franklin-content"><h3 id="proximal_gradient_descent"><a href="#proximal_gradient_descent" class="header-anchor">Proximal gradient descent</a></h3>
<p>I often forget how to derive proximal gradient descent. So here we go.</p>
<p>Proximal gradient descent is for solving the problem of this form:</p>
\[\min_{\bm z} f(\bm z)+g(\bm z)\]
<p>where \(f\) is a differentiable but \(g\) is not. The idea of proximal operator is to do a quadratic approximation of \(f\) at some point \(\bm x\) and solve that with \(g\). We replace the hessian \(\nabla^2 f\) by \(\frac{1}{\eta}I\). We want to solve:</p>
\[ \begin{align*}
    &\argmin_{\bm z}\, f(\bm x)+\nabla f(\bm x)^T(\bm z-\bm x)+\frac{1}{2\eta}\|\bm z-\bm x\|^2_2 + g(\bm z)\\
    =&\argmin_{\bm z}\, \frac{1}{2\eta}\|\bm z-(\bm x-\eta\nabla f(\bm x))\|^2_2 + g(\bm z)
   \end{align*}
\]
<p>The proximal operator \(\text{prox}_{g,\eta}(\bm z)\) is defined as the following:</p>
\[
\text{prox}_{g,\eta}(\bm x) = \argmin_{\bm z} \frac{1}{2\eta}\|\bm z - \bm x\|^2_2 + g(\bm z)
\]
<p>And proximal gradient descent is done by choosing an initial point \(\bm x^{(0)}\) and execute the following iterative procedure:</p>
\[
\bm x^{(k)} = \text{prox}_{g,\eta^k}(\bm x^{(k-1)}-\eta^k\nabla f(\bm x^{(k-1)})),\quad k=1,2,3...
\]
<p>There are many theoretical properties to show that this basically behaves like gradient descent. I&#39;d skip that for now.</p>
<h3 id="soft-thresholding_operator_with_01_constraint"><a href="#soft-thresholding_operator_with_01_constraint" class="header-anchor">Soft-thresholding operator with &#91;0,1&#93; constraint</a></h3>
<p>The problem I&#39;m interested in is </p>
\[\min_{\bm z} f(\bm z)+g(\bm z)\]
<p>where \(f(\bm z)=\frac{1}{2}\|\bm A\bm z-\bm b\|^2_2\) and \(g(\bm z)=\lambda\|\bm z\|_1+\Pi(\bm z)\). Here \(\Pi\) is an indicator function on \([0,1]^n\) hypercube that returns \(\infty\) if any \((z_1,...,z_n)\) falls outside of it.</p>
<p>One can see that the proximal operator for this is</p>
\[\bm z^{k+1}=\text{prox}_{g,\eta^k}(\bm z^k-\bm A^T(\bm A\bm z^k-\bm b))\]
<p>and the problem is </p>
\[\begin{align*}
\text{prox}_{g,\eta}(\bm x)&=\argmin_{\bm z}\, \lambda\|\bm z\|_1+\Pi(\bm z) + \frac{1}{2\eta}\|\bm z-\bm x\|^2_2 \\
    &=\argmin_{\bm z\in [0,1]^n}\, \lambda\|\bm z\|_1+ \frac{1}{2\eta}\|\bm z-\bm x\|^2_2
\end{align*}
\]
<p>since this is a separable problem, we can focus on the individual components:</p>
\[
\text{prox}_{g,\eta}(x_i) = \argmin_{z_i\in [0,1]} \lambda z_i + \frac{1}{2\eta}(z_i-x_i)^2
\]
<p>and hence the solution to this proximal operator problem is</p>
\[
\min\{\,\max \{0,\, x_i-\eta\lambda\, \},\, 1\}
\]
<p>for each component \(x_i\).</p>
<div class="page-foot">
    Contact me by <a href="mailto:skchu@wustl.edu">E-mail</a> | <a href="https://github.com/kchu25">Github</a> | <a href="https://www.linkedin.com/in/kchu1/">Linkedin</a>
    <br>
    This work is licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.  Last modified: October 06, 2025.
    <br>
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia language</a>.
</div>
</div><!-- CONTENT ENDS HERE -->
    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
  </body>
</html>
